"""This script is used to recollect the negative samples that should have been generated by the 'create_negative-coordinates.py' script.
NOTE: as the google static maps API limits daily calls to 25,000 calls only that many samples may be collected.
The script orignally attempted to collect all samples in 1 call, but now only collects 1 dataset per call.
"""

import csv

##Custom library import
import sys
sys.path.insert(1, '../lib')
import satellite_imagery
print(satellite_imagery.maptype)
##


set_to_recollect = 2 # This deteminres which random set is collected
zoom = 18



meta_data = csv.reader(open("../datasets_negative/#random_ranges.csv"), delimiter=',')
row = 0
for meta_row in meta_data:
    # !changes were made to the following two lines so only 1 set is collected!
    if meta_row[0] == ('lat1') or row is not set_to_recollect:
        row += 1
        continue
    line_count = 1
    ## Collects images from the specific dataset
    print(meta_row[5])
    with open('../datasets_negative/{}-10000.csv'.format(meta_row[5].strip())) as csvfile:
        csvreader = csv.reader(csvfile, delimiter=',')
        for row in csvreader:
            if line_count == 1:
                line_count += 1
            else:
                file_name = "../raw_data/0/{}_{:04d}.png".format(meta_row[6].strip(), line_count)
                image = satellite_imagery.grab_image(row[0], row[1], zoom, file_name)
                print('line: {} \t name: {}'.format(line_count, file_name))
                line_count += 1
    break #! This is added so only 1 dataset is collected.
print('done')
    
